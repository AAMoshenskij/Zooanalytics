# Аналитика сети зоомагазинов
Проект представляет собой комплексную систему анализа данных для сети зоомагазинов, построенную на современной стеках технологий обработки и визуализации данных. Архитектура проекта построена по принципу ETL-пайплайна, где данные последовательно проходят этапы извлечения, трансформации и загрузки. Исходные данные хранятся в виде CSV-файлов, которые содержат информацию о покупателях, продавцах, продуктах, магазинах и транзакциях.

На первом этапе данные загружаются в PostgreSQL — реляционную базу данных, где происходит их первичная обработка и нормализация. Для этого используются SQL-скрипты, которые создают структурированные таблицы с установленными связями между сущностями. База данных развернута в Docker-контейнере, что обеспечивает изоляцию и простоту развертывания всей системы.

Обработка больших объемов данных осуществляется с помощью Apache Spark. Spark-скрипты на Python выполняют сложные операции по распределению данных из сырых таблиц в нормализованную структуру, а также генерируют аналитические витрины для последующего анализа. Эти скрипты работают в кластерном режиме с главным узлом и рабочими воркерами, что позволяет обрабатывать данные параллельно и эффективно масштабироваться при росте нагрузки.

Для хранения аналитических данных используется ClickHouse — колоночная СУБД, оптимизированная для выполнения аналитических запросов. В ClickHouse загружаются предварительно агрегированные витрины данных, такие как топ продуктов по выручке, анализ клиентов по сегментам, динамика продаж по времени и другие ключевые метрики. Это позволяет выполнять сложные аналитические запросы с высокой производительностью.

Визуализация данных реализована с помощью Apache Superset — современной BI-платформы с открытым исходным кодом. Superset предоставляет богатые возможности для создания интерактивных дашбордов, графиков и таблиц, позволяя бизнес-пользователям самостоятельно исследовать данные без необходимости написания SQL-запросов. Платформа поддерживает различные типы визуализаций — от простых столбчатых диаграмм и линейных графиков до сложных тепловых карт и древовидных диаграмм. Были построено несколько графиков !<a href=https://github.com/AAMoshenskij/Zooanalytics/blob/main/graphics.jpg>Графики</a>


Все компоненты системы развернуты в Docker-контейнерах, что обеспечивает согласованность окружения и простоту развертывания. Docker Compose используется для оркестрации контейнеров, позволяя легко управлять всеми сервисами как единым целым. Сетевые взаимодействия между контейнерами настроены таким образом, чтобы обеспечить надежную коммуникацию между всеми компонентами системы.

Проект решает широкий спектр бизнес-задач: анализ эффективности продавцов, сегментация клиентов, выявление трендов продаж, оценка производительности магазинов и анализ товарного ассортимента. Система позволяет отслеживать ключевые метрики бизнеса в реальном времени, выявлять скрытые закономерности в данных и принимать обоснованные управленческие решения на основе актуальной аналитики.

Инфраструктура проекта демонстрирует полный цикл работы с данными — от сырых транзакций до готовых бизнес-инсайтов. Гибкость архитектуры позволяет легко расширять функциональность системы, добавлять новые источники данных и создавать дополнительные аналитические модули. Проект служит отличной основой для построения полноценной корпоративной системы бизнес-аналитики в розничной сети.

Запуск:
1) docker-compose up -d --build
2) docker exec -it abd2_spark pip install psycopg2-binary
2) docker exec -it abd2_spark bash -c "
  export SPARK_HOME=/opt/bitnami/spark && \
  export IVY2_HOME=/tmp/.ivy2 && \
  /opt/bitnami/spark/bin/spark-submit \
    --master spark://spark:7077 \
    --conf spark.jars=/opt/bitnami/spark/jars/postgresql-42.5.0.jar \
    --conf spark.driver.extraClassPath=/opt/bitnami/spark/jars/postgresql-42.5.0.jar \
    --conf spark.executor.extraClassPath=/opt/bitnami/spark/jars/postgresql-42.5.0.jar \
    /app/data_distribution.py
"
3) docker exec -it abd2_spark /opt/bitnami/spark/bin/spark-submit   --driver-class-path /opt/bitnami/spark/jars/postgresql-42.5.0.jar:/opt/bitnami/spark/jars/clickhouse-jdbc-0.4.6.jar   /app/create_reports.py

Примеры запросов:
user@user-GF63-Thin-11UD:~/ABD_labs/lab22$ curl -X POST "http://localhost:8123?user=default&password=your_secure_password"   --data "SELECT * FROM top_customers ORDER BY total_spent DESC LIMIT 5"
30475   Katerine        Screech Croatia 178702.08       384     465.37
34146   Tadio   Care    China   136622.88       306     446.48
27053   Basilius        Lambie  Portugal        132072.96       384     343.94
29208   Paulette        McCooke Portugal        116232.9        294     395.35
34612   Gratiana        Turtle  Indonesia       90253.68        204     442.42

user@user-GF63-Thin-11UD:~/ABD_labs/lab22$ curl -X POST "http://localhost:8123?user=default&password=your_secure_password"   --data "SELECT * FROM top_products LIMIT 5"
27977   Dog Food        Cage    60224   384     2.5     81664
30642   Cat Toy Cage    63502.82        1077    4.5     47763
31515   Dog Food        Food    56757.87        495     2.7     16113
32468   Bird Cage       Cage    58795.16        767     4.1     636
32561   Cat Toy Food    63502.82        1077    1.1     142557

